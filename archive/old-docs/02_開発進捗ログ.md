# RepoTomo 開発進捗ログ

## 2025年1月 - プロジェクト再構築

### 2025/01/20
- 技術スタック変更: GAS → React + Supabase + Vercel
- 超低コスト構成への設計変更（月額0円〜数百円）
- 技術仕様書作成完了（データベース、API、セキュリティ、環境、デプロイ）

### 2025/07/23
- WSL環境での開発から Windows ネイティブ環境へ移行
- Git for Windows 導入による安定した開発環境構築
- TypeScript型設計のベストプラクティス実装開始

### 現在のタスクリスト

#### フェーズ1: 環境構築（2025/01末）
- [ ] Supabaseプロジェクト作成
- [ ] PostgreSQLデータベース設計・マイグレーション
- [ ] Vercelプロジェクトセットアップ
- [ ] Cloudflare DNS設定
- [ ] LINE Developerアカウント設定

#### フェーズ2: MVP実装（2025/02）
- [ ] Reactアプリケーション基本構造
- [ ] Supabase Auth連携（LINE Login）
- [ ] 報告書提出機能（コア機能）
- [ ] 管理者ダッシュボード基本機能
- [ ] リアルタイム通知（Supabase Realtime）

#### フェーズ3: PWA完成（2025/03）
- [ ] Service Worker実装（オフライン対応）
- [ ] プッシュ通知機能
- [ ] アチーブメントシステム
- [ ] 相談・質問機能
- [ ] 音声入力対応（Web Speech API）

## 技術的な決定事項

### アーキテクチャ決定
- **フロントエンド**: React 18 + TypeScript + Vite + Tailwind CSS
- **バックエンド**: Supabase (PostgreSQL + Auth + Edge Functions)
- **ホスティング**: Vercel + Cloudflare
- **PWA**: Vite PWA Plugin
- **状態管理**: Zustand + React Query

### データベース設計（PostgreSQL）

**staffテーブル**
```sql
CREATE TABLE staff (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  staff_id TEXT UNIQUE NOT NULL,
  name TEXT NOT NULL,
  line_user_id TEXT UNIQUE,
  role TEXT DEFAULT 'STAFF',
  is_active BOOLEAN DEFAULT true,
  preferred_reminder_time TIME DEFAULT '18:00'
);
```

**submissionsテーブル**
```sql
CREATE TABLE submissions (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  staff_id UUID REFERENCES staff(id),
  report_id UUID REFERENCES report_templates(id),
  answers JSONB,
  mood TEXT CHECK (mood IN ('happy', 'neutral', 'need_help')),
  has_question BOOLEAN DEFAULT false,
  question TEXT,
  submitted_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

### Supabase API設計
**認証エンドポイント**
- Supabase Auth (LINE Login)
- Row Level Security (RLS)

**データアクセス**
- Supabase JavaScript Client
- 自動生成されるREST API
- リアルタイムSubscriptions

**Edge Functions**
- LINE Messaging API Webhook
- リマインダー送信処理

## コスト最適化戦略

### 無料枠内での運用
- **Supabase Free**: 500MB DB + 認証 + Edge Functions
- **Vercel Hobby**: 100GB帯域 + 6000分ビルド時間
- **Cloudflare Free**: CDN + DNS
- **LINE API**: 月1000通無料

### モニタリング項目
- データベースサイズ (500MB以内)
- 月間アクティブユーザー数 (50,000以内)
- Vercel帯域使用量 (100GB以内)
- LINEメッセージ送信数 (月1000通以内)

### 課題・検討事項
- データベース容量管理（古いデータの自動削除）
- パフォーマンス最適化（キャッシュ活用）
- PWAオフライン機能の範囲
- セキュリティ・認証フローの詳細設計

## 実装進捗

### 完了済み
- [x] プロジェクト概要作成
- [x] マスタープロンプト作成
- [x] 技術仕様書作成（5種）
- [x] 基本的なディレクトリ構造設計

### 進行中
- [ ] TypeScript型定義の実装
- [ ] Supabaseクライアント設定
- [ ] 認証フック実装

### 未着手
- [ ] UIコンポーネント実装
- [ ] PWA設定
- [ ] デプロイ設定

## 参考資料
- [Supabase公式ドキュメント](https://supabase.com/docs)
- [Vercel公式ドキュメント](https://vercel.com/docs)
- [React 18公式ドキュメント](https://react.dev/)
- [Vite PWA Plugin](https://vite-pwa-org.netlify.app/)
- [LINE Messaging API](https://developers.line.biz/ja/docs/messaging-api/)
- [Tailwind CSS](https://tailwindcss.com/docs) 